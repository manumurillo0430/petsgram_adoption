{"ast":null,"code":"import _regeneratorRuntime from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import*as yup from'yup';import FormSubmitButtom from'../form/FormSubmitButtom';import FormInputField from'../form/FormInputField';import FormPasswordField from'../form/FormPasswordField';import{requiredField,userNameTooShort,passwordTooShort}from'../../utils/globals';import{Formik}from'formik';import{PostReq}from'../../utils/api';import{useState}from'react';import{useAuthContext}from'../../context/AuthContext';import{Text}from'@chakra-ui/react';import{useSearchContext}from'../../context/SearchContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function LoginForm(_ref){var toggleModal=_ref.toggleModal;console.log(toggleModal);var _useAuthContext=useAuthContext(),getCurrentUser=_useAuthContext.getCurrentUser;var getUserLikes=useSearchContext.getUserLikes;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),serverError=_useState2[0],setServerError=_useState2[1];var loginSchema=yup.object().shape({email:yup.string().required(requiredField).min(6,userNameTooShort),password:yup.string().required(requiredField).min(6,passwordTooShort)});return/*#__PURE__*/_jsx(Formik,{initialValues:{email:'',password:''},validationSchema:loginSchema,validateOnChange:false,onSubmit:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setServerError('');_context.next=4;return PostReq('/user/login/',user);case 4:res=_context.sent;console.log(res.token,'userid:',res.user_id,res.user_likes);if(!res){_context.next=12;break;}toggleModal();_context.next=10;return getCurrentUser(res.user_id);case 10:_context.next=12;return getUserLikes(res.user_likes);case 12:_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);if(_context.t0.response&&_context.t0.response.data&&_context.t0.response.data.error){setServerError(_context.t0.response.data.error);}else{setServerError('An error occurred. Please try again later.');}case 17:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return function(_x){return _ref2.apply(this,arguments);};}(),children:function children(_ref3){var handleSubmit=_ref3.handleSubmit;return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInputField,{req:true,fieldName:\"email\",fieldLabel:\"Email\"}),/*#__PURE__*/_jsx(FormPasswordField,{req:true,fieldName:\"password\",fieldLabel:\"Password\"}),/*#__PURE__*/_jsx(FormSubmitButtom,{buttonLabel:\"Log In\"}),serverError?/*#__PURE__*/_jsx(Text,{children:serverError}):'']});}});}","map":{"version":3,"names":["React","yup","FormSubmitButtom","FormInputField","FormPasswordField","requiredField","userNameTooShort","passwordTooShort","Formik","PostReq","useState","useAuthContext","Text","useSearchContext","jsx","_jsx","jsxs","_jsxs","LoginForm","_ref","toggleModal","console","log","_useAuthContext","getCurrentUser","getUserLikes","_useState","_useState2","_slicedToArray","serverError","setServerError","loginSchema","object","shape","email","string","required","min","password","initialValues","validationSchema","validateOnChange","onSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","user","res","wrap","_callee$","_context","prev","next","sent","token","user_id","user_likes","t0","response","data","error","stop","_x","apply","arguments","children","_ref3","handleSubmit","req","fieldName","fieldLabel","buttonLabel"],"sources":["/Users/manumurillo/Downloads/petsgram_adoption/client/src/components/registration/LoginForm.jsx"],"sourcesContent":["import React from 'react'\nimport * as yup from 'yup'\nimport FormSubmitButtom from '../form/FormSubmitButtom'\nimport FormInputField from '../form/FormInputField'\nimport FormPasswordField from '../form/FormPasswordField'\nimport { requiredField, userNameTooShort, passwordTooShort } from '../../utils/globals'\nimport { Formik } from 'formik'\nimport { PostReq } from '../../utils/api'\nimport { useState } from 'react'\nimport { useAuthContext } from '../../context/AuthContext'\nimport { Text } from '@chakra-ui/react'\nimport { useSearchContext } from '../../context/SearchContext'\n\nexport default function LoginForm({ toggleModal }) {\n    console.log(toggleModal)\n    const { getCurrentUser } = useAuthContext()\n    const { getUserLikes } = useSearchContext\n    const [serverError, setServerError] = useState(false)\n    const loginSchema = yup.object().shape({\n        email: yup.string().required(requiredField).min(6, userNameTooShort),\n        password: yup.string().required(requiredField).min(6, passwordTooShort),\n    })\n\n    return (\n        <Formik\n            initialValues={{\n                email: '',\n                password: '',\n            }}\n            validationSchema={loginSchema}\n            validateOnChange={false}\n            onSubmit={async (user) => {\n                try {\n                    setServerError('')\n                    const res = await PostReq('/user/login/', user)\n                    console.log(res.token, 'userid:', res.user_id, res.user_likes)\n                    if (res) {\n                        toggleModal()\n                        await getCurrentUser(res.user_id)\n                        await getUserLikes(res.user_likes)\n                    }\n                } catch (error) {\n                    if (error.response && error.response.data && error.response.data.error) {\n                        setServerError(error.response.data.error)\n                    } else {\n                        setServerError('An error occurred. Please try again later.')\n                    }\n                }\n            }}\n        >\n            {({ handleSubmit }) => (\n                <form onSubmit={handleSubmit}>\n                    <FormInputField req={true} fieldName=\"email\" fieldLabel=\"Email\" />\n                    <FormPasswordField req={true} fieldName=\"password\" fieldLabel=\"Password\" />\n                    <FormSubmitButtom buttonLabel=\"Log In\" />\n                    {serverError ? <Text>{serverError}</Text> : ''}\n                </form>\n            )}\n        </Formik>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}