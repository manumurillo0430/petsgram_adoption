{"ast":null,"code":"import _regeneratorRuntime from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/manumurillo/Downloads/petsgram_adoption/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{React,useState}from'react';import{useAuthContext}from'../../context/AuthContext';import FormPasswordField from'../form/FormPasswordField';import{requiredField}from'../../utils/globals';import*as yup from'yup';import{Formik}from'formik';import{Avatar,Divider}from'antd';import{Text,Box,Center,Spinner,useToast}from'@chakra-ui/react';import FormSubmitButtom from'../form/FormSubmitButtom';import{PutReq}from'../../utils/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChangePasswordForm(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),changingUserPassword=_useState2[0],sethCangingUserPassword=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),serverError=_useState4[0],setServerError=_useState4[1];var _useAuthContext=useAuthContext(),currentUser=_useAuthContext.currentUser,userId=_useAuthContext.userId;var toast=useToast({title:'Password updated.',description:\"We've updated your password.\",status:'success',duration:6000,isClosable:true,position:'top'});var updatePasswordSchema=yup.object().shape({currentpassword:yup.string().required(requiredField),password:yup.string().required(requiredField).min(8,'Password must be at least 8 characters.'),repeatpassword:yup.string().required(requiredField).oneOf([yup.ref('password')],'Passwords must match.')});return/*#__PURE__*/_jsx(Formik,{initialValues:{currentpassword:'',password:'',repeatpassword:''},validationSchema:updatePasswordSchema,validateOnChange:false,onSubmit:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values,_ref){var resetForm,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:resetForm=_ref.resetForm;sethCangingUserPassword(true);_context.prev=2;_context.next=5;return PutReq(\"/user/password/\".concat(currentUser.user_id),values);case 5:res=_context.sent;if(res){setServerError(false);sethCangingUserPassword(false);toast();resetForm();}_context.next=14;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);console.log(_context.t0);setServerError(_context.t0.response.data);sethCangingUserPassword(false);case 14:case\"end\":return _context.stop();}},_callee,null,[[2,9]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}(),children:function children(_ref3){var handleSubmit=_ref3.handleSubmit;return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Divider,{style:{border:'none'}}),/*#__PURE__*/_jsxs(Center,{alignContent:\"end\",flexDirection:\"column\",justifyContent:\"center\",children:[/*#__PURE__*/_jsx(Avatar,{size:80,src:currentUser===null||currentUser===void 0?void 0:currentUser.picture}),/*#__PURE__*/_jsxs(Text,{mt:3,fontWeight:\"bold\",children:[' ',currentUser.firstname,\" \",currentUser.lastname]})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Center,{children:/*#__PURE__*/_jsxs(Box,{w:\"50%\",display:\"flex\",justifyContent:\"center\",flexDirection:\"column\",children:[/*#__PURE__*/_jsx(FormPasswordField,{fieldLabel:\"Current Password\",fieldName:\"currentpassword\",req:true}),/*#__PURE__*/_jsx(FormPasswordField,{fieldLabel:\"New Password\",fieldName:\"password\",req:true}),/*#__PURE__*/_jsx(FormPasswordField,{fieldLabel:\"Confirm New Password\",fieldName:\"repeatpassword\",req:true}),serverError?/*#__PURE__*/_jsx(Text,{color:\"red\",fontWeight:\"500\",mt:4,textAlign:\"center\",children:serverError}):null,/*#__PURE__*/_jsx(FormSubmitButtom,{buttonLabel:!changingUserPassword?'Save Changes':/*#__PURE__*/_jsx(Spinner,{})})]})})]});}});}","map":{"version":3,"names":["React","useState","useAuthContext","FormPasswordField","requiredField","yup","Formik","Avatar","Divider","Text","Box","Center","Spinner","useToast","FormSubmitButtom","PutReq","jsx","_jsx","jsxs","_jsxs","ChangePasswordForm","_useState","_useState2","_slicedToArray","changingUserPassword","sethCangingUserPassword","_useState3","_useState4","serverError","setServerError","_useAuthContext","currentUser","userId","toast","title","description","status","duration","isClosable","position","updatePasswordSchema","object","shape","currentpassword","string","required","password","min","repeatpassword","oneOf","ref","initialValues","validationSchema","validateOnChange","onSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","_ref","resetForm","res","wrap","_callee$","_context","prev","next","concat","user_id","sent","t0","console","log","response","data","stop","_x","_x2","apply","arguments","children","_ref3","handleSubmit","style","border","alignContent","flexDirection","justifyContent","size","src","picture","mt","fontWeight","firstname","lastname","w","display","fieldLabel","fieldName","req","color","textAlign","buttonLabel"],"sources":["/Users/manumurillo/Downloads/petsgram_adoption/client/src/components/profile/ChangePasswordForm.jsx"],"sourcesContent":["import { React, useState } from 'react'\nimport { useAuthContext } from '../../context/AuthContext'\nimport FormPasswordField from '../form/FormPasswordField'\nimport { requiredField } from '../../utils/globals'\nimport * as yup from 'yup'\nimport { Formik } from 'formik'\nimport { Avatar, Divider } from 'antd'\nimport { Text, Box, Center, Spinner, useToast } from '@chakra-ui/react'\nimport FormSubmitButtom from '../form/FormSubmitButtom'\nimport { PutReq } from '../../utils/api'\n\nexport default function ChangePasswordForm() {\n    const [changingUserPassword, sethCangingUserPassword] = useState(false)\n    const [serverError, setServerError] = useState(false)\n    const { currentUser, userId } = useAuthContext()\n    const toast = useToast({\n        title: 'Password updated.',\n        description: \"We've updated your password.\",\n        status: 'success',\n        duration: 6000,\n        isClosable: true,\n        position: 'top',\n    })\n\n    const updatePasswordSchema = yup.object().shape({\n        currentpassword: yup.string().required(requiredField),\n        password: yup.string().required(requiredField).min(8, 'Password must be at least 8 characters.'),\n        repeatpassword: yup\n            .string()\n            .required(requiredField)\n            .oneOf([yup.ref('password')], 'Passwords must match.'),\n    })\n\n    return (\n        <Formik\n            initialValues={{\n                currentpassword: '',\n                password: '',\n                repeatpassword: '',\n            }}\n            validationSchema={updatePasswordSchema}\n            validateOnChange={false}\n            onSubmit={async (values, { resetForm }) => {\n                sethCangingUserPassword(true)\n                try {\n                    const res = await PutReq(`/user/password/${currentUser.user_id}`, values)\n                    if (res) {\n                        setServerError(false)\n                        sethCangingUserPassword(false)\n                        toast()\n                        resetForm()\n                    }\n                } catch (error) {\n                    console.log(error)\n                    setServerError(error.response.data)\n                    sethCangingUserPassword(false)\n                }\n            }}\n        >\n            {({ handleSubmit }) => (\n                <form onSubmit={handleSubmit}>\n                    <Divider style={{ border: 'none' }} />\n                    <Center alignContent=\"end\" flexDirection=\"column\" justifyContent=\"center\">\n                        <Avatar size={80} src={currentUser?.picture} />\n                        <Text mt={3} fontWeight=\"bold\">\n                            {' '}\n                            {currentUser.firstname} {currentUser.lastname}\n                        </Text>\n                    </Center>\n                    <Divider />\n                    <Center>\n                        <Box w=\"50%\" display=\"flex\" justifyContent=\"center\" flexDirection=\"column\">\n                            <FormPasswordField fieldLabel=\"Current Password\" fieldName=\"currentpassword\" req={true} />\n                            <FormPasswordField fieldLabel=\"New Password\" fieldName=\"password\" req={true} />\n                            <FormPasswordField\n                                fieldLabel=\"Confirm New Password\"\n                                fieldName=\"repeatpassword\"\n                                req={true}\n                            />\n                            {serverError ? (\n                                <Text color=\"red\" fontWeight=\"500\" mt={4} textAlign=\"center\">\n                                    {serverError}\n                                </Text>\n                            ) : null}\n                            <FormSubmitButtom buttonLabel={!changingUserPassword ? 'Save Changes' : <Spinner />} />\n                        </Box>\n                    </Center>\n                </form>\n            )}\n        </Formik>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}