{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resolveHref = resolveHref;\nvar _querystring = require(\"./querystring\");\nvar _formatUrl = require(\"./format-url\");\nvar _omit = require(\"./omit\");\nvar _utils = require(\"../../utils\");\nvar _normalizeTrailingSlash = require(\"../../../../client/normalize-trailing-slash\");\nvar _isLocalUrl = require(\"./is-local-url\");\nvar _isDynamic = require(\"./is-dynamic\");\nvar _interpolateAs = require(\"./interpolate-as\");\nfunction resolveHref(router, href, resolveAs) {\n  // we use a dummy base url for relative urls\n  var base;\n  var urlAsString = typeof href === 'string' ? href : (0, _formatUrl).formatWithValidation(href);\n  // repeated slashes and backslashes in the URL are considered\n  // invalid and will never match a Next.js page/file\n  var urlProtoMatch = urlAsString.match(/^[a-zA-Z]{1,}:\\/\\//);\n  var urlAsStringNoProto = urlProtoMatch ? urlAsString.slice(urlProtoMatch[0].length) : urlAsString;\n  var urlParts = urlAsStringNoProto.split('?');\n  if ((urlParts[0] || '').match(/(\\/\\/|\\\\)/)) {\n    console.error(\"Invalid href '\".concat(urlAsString, \"' passed to next/router in page: '\").concat(router.pathname, \"'. Repeated forward-slashes (//) or backslashes \\\\ are not valid in the href.\"));\n    var normalizedUrl = (0, _utils).normalizeRepeatedSlashes(urlAsStringNoProto);\n    urlAsString = (urlProtoMatch ? urlProtoMatch[0] : '') + normalizedUrl;\n  }\n  // Return because it cannot be routed by the Next.js router\n  if (!(0, _isLocalUrl).isLocalURL(urlAsString)) {\n    return resolveAs ? [urlAsString] : urlAsString;\n  }\n  try {\n    base = new URL(urlAsString.startsWith('#') ? router.asPath : router.pathname, 'http://n');\n  } catch (_) {\n    // fallback to / for invalid asPath values e.g. //\n    base = new URL('/', 'http://n');\n  }\n  try {\n    var finalUrl = new URL(urlAsString, base);\n    finalUrl.pathname = (0, _normalizeTrailingSlash).normalizePathTrailingSlash(finalUrl.pathname);\n    var interpolatedAs = '';\n    if ((0, _isDynamic).isDynamicRoute(finalUrl.pathname) && finalUrl.searchParams && resolveAs) {\n      var query = (0, _querystring).searchParamsToUrlQuery(finalUrl.searchParams);\n      var _interpolateAs2 = (0, _interpolateAs).interpolateAs(finalUrl.pathname, finalUrl.pathname, query),\n        result = _interpolateAs2.result,\n        params = _interpolateAs2.params;\n      if (result) {\n        interpolatedAs = (0, _formatUrl).formatWithValidation({\n          pathname: result,\n          hash: finalUrl.hash,\n          query: (0, _omit).omit(query, params)\n        });\n      }\n    }\n    // if the origin didn't change, it means we received a relative href\n    var resolvedHref = finalUrl.origin === base.origin ? finalUrl.href.slice(finalUrl.origin.length) : finalUrl.href;\n    return resolveAs ? [resolvedHref, interpolatedAs || resolvedHref] : resolvedHref;\n  } catch (_1) {\n    return resolveAs ? [urlAsString] : urlAsString;\n  }\n}","map":{"version":3,"names":["resolveHref","_querystring","require","_formatUrl","_omit","_utils","_normalizeTrailingSlash","_isLocalUrl","_isDynamic","_interpolateAs","router","href","resolveAs","base","urlAsString","formatWithValidation","urlProtoMatch","match","urlAsStringNoProto","slice","length","urlParts","split","console","error","concat","pathname","normalizedUrl","normalizeRepeatedSlashes","isLocalURL","URL","startsWith","asPath","_","finalUrl","normalizePathTrailingSlash","interpolatedAs","isDynamicRoute","searchParams","query","searchParamsToUrlQuery","_interpolateAs2","interpolateAs","result","params","hash","omit","resolvedHref","origin","_1"],"sources":["../../../../../src/shared/lib/router/utils/resolve-href.ts"],"sourcesContent":[null],"mappings":"AAAA;;;;;QAyBgBA,WAAW,GAAXA,WAAW;AAvBY,IAAAC,YAAe,GAAAC,OAAA,CAAf,eAAe;AACjB,IAAAC,UAAc,GAAAD,OAAA,CAAd,cAAc;AAC9B,IAAAE,KAAQ,GAAAF,OAAA,CAAR,QAAQ;AACY,IAAAG,MAAa,GAAAH,OAAA,CAAb,aAAa;AACX,IAAAI,uBAA6C,GAAAJ,OAAA,CAA7C,6CAA6C;AAC7D,IAAAK,WAAgB,GAAAL,OAAA,CAAhB,gBAAgB;AACZ,IAAAM,UAAc,GAAAN,OAAA,CAAd,cAAc;AACf,IAAAO,cAAkB,GAAAP,OAAA,CAAlB,kBAAkB;AAgBzC,SAASF,WAAWA,CACzBU,MAAkB,EAClBC,IAAS,EACTC,SAAmB,EACmB;EACtC;EACA,IAAIC,IAAI;EACR,IAAIC,WAAW,GAAG,OAAOH,IAAI,KAAK,QAAQ,GAAGA,IAAI,GAAG,IAAAR,UAAoB,EAAMY,oBAAN,CAACJ,IAAI,CAAC;EAE9E;EACA;EACA,IAAMK,aAAa,GAAGF,WAAW,CAACG,KAAK,sBAAsB;EAC7D,IAAMC,kBAAkB,GAAGF,aAAa,GACpCF,WAAW,CAACK,KAAK,CAACH,aAAa,CAAC,CAAC,CAAC,CAACI,MAAM,CAAC,GAC1CN,WAAW;EAEf,IAAMO,QAAQ,GAAGH,kBAAkB,CAACI,KAAK,CAAC,GAAG,CAAC;EAE9C,IAAI,CAACD,QAAQ,CAAC,CAAC,CAAC,IAAI,EAAE,EAAEJ,KAAK,aAAa,EAAE;IAC1CM,OAAO,CAACC,KAAK,kBAAAC,MAAA,CACMX,WAAW,wCAAAW,MAAA,CAAqCf,MAAM,CAACgB,QAAQ,mFACjF;IACD,IAAMC,aAAa,GAAG,IAAAtB,MAAwB,EAAoBuB,wBAApB,CAACV,kBAAkB,CAAC;IAClEJ,WAAW,GAAG,CAACE,aAAa,GAAGA,aAAa,CAAC,CAAC,CAAC,GAAG,EAAE,IAAIW,aAAa;;EAGvE;EACA,IAAI,CAAC,IAAApB,WAAU,EAAasB,UAAb,CAACf,WAAW,CAAC,EAAE;IAC5B,OAAQF,SAAS,GAAG,CAACE,WAAW,CAAC,GAAGA,WAAW;;EAGjD,IAAI;IACFD,IAAI,GAAG,IAAIiB,GAAG,CACZhB,WAAW,CAACiB,UAAU,CAAC,GAAG,CAAC,GAAGrB,MAAM,CAACsB,MAAM,GAAGtB,MAAM,CAACgB,QAAQ,EAC7D,UAAU,CACX;GACF,CAAC,OAAOO,CAAC,EAAE;IACV;IACApB,IAAI,GAAG,IAAIiB,GAAG,CAAC,GAAG,EAAE,UAAU,CAAC;;EAGjC,IAAI;IACF,IAAMI,QAAQ,GAAG,IAAIJ,GAAG,CAAChB,WAAW,EAAED,IAAI,CAAC;IAC3CqB,QAAQ,CAACR,QAAQ,GAAG,IAAApB,uBAA0B,EAAmB6B,0BAAnB,CAACD,QAAQ,CAACR,QAAQ,CAAC;IACjE,IAAIU,cAAc,GAAG,EAAE;IAEvB,IACE,IAAA5B,UAAc,EAAmB6B,cAAnB,CAACH,QAAQ,CAACR,QAAQ,CAAC,IACjCQ,QAAQ,CAACI,YAAY,IACrB1B,SAAS,EACT;MACA,IAAM2B,KAAK,GAAG,IAAAtC,YAAsB,EAAuBuC,sBAAvB,CAACN,QAAQ,CAACI,YAAY,CAAC;MAE3D,IAAAG,eAAA,GAA2B,IAAAhC,cAAa,EAIvCiC,aAJuC,CACtCR,QAAQ,CAACR,QAAQ,EACjBQ,QAAQ,CAACR,QAAQ,EACjBa,KAAK,CACN;QAJOI,MAAM,GAAAF,eAAA,CAANE,MAAM;QAAEC,MAAM,GAAAH,eAAA,CAANG,MAAM;MAMtB,IAAID,MAAM,EAAE;QACVP,cAAc,GAAG,IAAAjC,UAAoB,EAInCY,oBAJmC,CAAC;UACpCW,QAAQ,EAAEiB,MAAM;UAChBE,IAAI,EAAEX,QAAQ,CAACW,IAAI;UACnBN,KAAK,EAAE,IAAAnC,KAAI,EAAe0C,IAAf,CAACP,KAAK,EAAEK,MAAM;SAC1B,CAAC;;;IAIN;IACA,IAAMG,YAAY,GAChBb,QAAQ,CAACc,MAAM,KAAKnC,IAAI,CAACmC,MAAM,GAC3Bd,QAAQ,CAACvB,IAAI,CAACQ,KAAK,CAACe,QAAQ,CAACc,MAAM,CAAC5B,MAAM,CAAC,GAC3Cc,QAAQ,CAACvB,IAAI;IAEnB,OAAOC,SAAS,GACZ,CAACmC,YAAY,EAAEX,cAAc,IAAIW,YAAY,CAAC,GAC9CA,YAAY;GACjB,CAAC,OAAOE,EAAC,EAAE;IACV,OAAOrC,SAAS,GAAG,CAACE,WAAW,CAAC,GAAGA,WAAW"},"metadata":{},"sourceType":"script","externalDependencies":[]}